{"version":3,"file":"get_recommendations.js","sources":["src/js/api_config.js","src/js/utils.js","src/js/get_recommendations.js"],"sourcesContent":["export default {\n    api_url: 'http://localhost:7001'\n}","const escapeHtml = (unsafe) => {\n    return unsafe.replaceAll('&', '&amp;').replaceAll('<', '&lt;').replaceAll('>', '&gt;').replaceAll('\"', '&quot;').replaceAll(\"'\", '&#039;');\n}\n\nexport {\n    escapeHtml\n}","import API_CONFIG from './api_config.js';\nimport { escapeHtml } from './utils.js';\n\ndocument.addEventListener('DOMContentLoaded', function() {\n\n    function getAndPreperateParameters() {\n        const urlParams = new URLSearchParams(window.location.search);\n        const params = Object.fromEntries(urlParams.entries());\n        // Preprocess parameters\n        delete params['save_form_vals'];\n        for (const key of ['attack', 'crit']) {\n            params[key] = parseInt(params[key]);\n        }\n        for (const key of ['attack_amplifier', 'crit_rate', 'crit_dmg', \n                'break_rate', 'dmg_increase', 'pvp_dmg_increase', 'pierce_rate']) {\n            params[key] = parseFloat(params[key]) / 100;\n        }\n        return params;\n    }\n\n    const recommendationContainer = document.getElementById('recommendation-container');\n    function addToRecommendationContainer(html) {\n        if(recommendationContainer) {\n            recommendationContainer.innerHTML += html;\n        }\n    }\n    function createAndInsertAlert(alertText) {\n        const alertHTML = `\n            <div class=\"rest-failure-alert\">\n                <div class=\"alert alert-danger\" role=\"alert\">` + escapeHtml(alertText) + `</div>\n\n                <a href=\"index.html\">Go bath to the home page</a>\n            </div>`;\n        addToRecommendationContainer(alertHTML);\n    }\n    function addRecommendations(data) {\n        console.log(data);\n        const recommendationHTML = `\n            <h1>Recommendations against player ` + escapeHtml(data['player']) + `</h1>\n        `;\n        addToRecommendationContainer(recommendationHTML);\n    }\n\n    const recommendationsEndPoint = `${API_CONFIG.api_url}/calculate`;\n\n    fetch(recommendationsEndPoint, {\n        method: 'POST',\n        body: JSON.stringify(getAndPreperateParameters()),\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    })\n    .then(response => {\n        if(!response.ok) {\n            throw new Error();\n        }\n        return response.text();\n    })\n    .then(data => {\n        data = JSON.parse(data);\n        addRecommendations(data);\n    })\n    .catch(err => {\n        console.log(err);\n        createAndInsertAlert('Issues processing the request. Please try again later.');\n    });\n});"],"names":["api_url","escapeHtml","unsafe","replaceAll","document","addEventListener","getAndPreperateParameters","urlParams","URLSearchParams","window","location","search","params","Object","fromEntries","entries","_i","_arr","length","key","parseInt","_i2","_arr2","parseFloat","recommendationContainer","getElementById","addToRecommendationContainer","html","innerHTML","createAndInsertAlert","alertText","alertHTML","addRecommendations","data","console","log","recommendationHTML","recommendationsEndPoint","concat","API_CONFIG","fetch","method","body","JSON","stringify","headers","then","response","ok","Error","text","parse","err"],"mappings":";;;AAAA,qBAAe;MACXA,OAAO,EAAE;IACb,CAAC;;ICFD,IAAMC,UAAU,GAAG,SAAbA,UAAUA,CAAIC,MAAM,EAAK;MAC3B,OAAOA,MAAM,CAACC,UAAU,CAAC,GAAG,EAAE,OAAO,CAAC,CAACA,UAAU,CAAC,GAAG,EAAE,MAAM,CAAC,CAACA,UAAU,CAAC,GAAG,EAAE,MAAM,CAAC,CAACA,UAAU,CAAC,GAAG,EAAE,QAAQ,CAAC,CAACA,UAAU,CAAC,GAAG,EAAE,QAAQ,CAAC;IAC9I,CAAC;;ICCDC,QAAQ,CAACC,gBAAgB,CAAC,kBAAkB,EAAE,YAAW;MAErD,SAASC,yBAAyBA,GAAG;QACjC,IAAMC,SAAS,GAAG,IAAIC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;QAC7D,IAAMC,MAAM,GAAGC,MAAM,CAACC,WAAW,CAACP,SAAS,CAACQ,OAAO,EAAE,CAAC;;QAEtD,OAAOH,MAAM,CAAC,gBAAgB,CAAC;QAC/B,SAAAI,EAAA,MAAAC,IAAA,GAAkB,CAAC,QAAQ,EAAE,MAAM,CAAC,EAAAD,EAAA,GAAAC,IAAA,CAAAC,MAAA,EAAAF,EAAA,IAAE;UAAjC,IAAMG,GAAG,GAAAF,IAAA,CAAAD,EAAA;UACVJ,MAAM,CAACO,GAAG,CAAC,GAAGC,QAAQ,CAACR,MAAM,CAACO,GAAG,CAAC,CAAC;;QAEvC,SAAAE,GAAA,MAAAC,KAAA,GAAkB,CAAC,kBAAkB,EAAE,WAAW,EAAE,UAAU,EACtD,YAAY,EAAE,cAAc,EAAE,kBAAkB,EAAE,aAAa,CAAC,EAAAD,GAAA,GAAAC,KAAA,CAAAJ,MAAA,EAAAG,GAAA,IAAE;UADrE,IAAMF,IAAG,GAAAG,KAAA,CAAAD,GAAA;UAEVT,MAAM,CAACO,IAAG,CAAC,GAAGI,UAAU,CAACX,MAAM,CAACO,IAAG,CAAC,CAAC,GAAG,GAAG;;QAE/C,OAAOP,MAAM;;MAGjB,IAAMY,uBAAuB,GAAGpB,QAAQ,CAACqB,cAAc,CAAC,0BAA0B,CAAC;MACnF,SAASC,4BAA4BA,CAACC,IAAI,EAAE;QACxC,IAAGH,uBAAuB,EAAE;UACxBA,uBAAuB,CAACI,SAAS,IAAID,IAAI;;;MAGjD,SAASE,oBAAoBA,CAACC,SAAS,EAAE;QACrC,IAAMC,SAAS,GAAG,wHAEuC9B,UAAU,CAAC6B,SAAS,CAAC,sGAGnE;QACXJ,4BAA4B,CAACK,SAAS,CAAC;;MAE3C,SAASC,kBAAkBA,CAACC,IAAI,EAAE;QAC9BC,OAAO,CAACC,GAAG,CAACF,IAAI,CAAC;QACjB,IAAMG,kBAAkB,GAAG,sDACgBnC,UAAU,CAACgC,IAAI,CAAC,QAAQ,CAAC,CAAC,oBACpE;QACDP,4BAA4B,CAACU,kBAAkB,CAAC;;MAGpD,IAAMC,uBAAuB,MAAAC,MAAA,CAAMC,UAAU,CAACvC,OAAO,eAAY;MAEjEwC,KAAK,CAACH,uBAAuB,EAAE;QAC3BI,MAAM,EAAE,MAAM;QACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACtC,yBAAyB,EAAE,CAAC;QACjDuC,OAAO,EAAE;UACL,cAAc,EAAE;;OAEvB,CAAC,CACDC,IAAI,CAAC,UAAAC,QAAQ,EAAI;QACd,IAAG,CAACA,QAAQ,CAACC,EAAE,EAAE;UACb,MAAM,IAAIC,KAAK,EAAE;;QAErB,OAAOF,QAAQ,CAACG,IAAI,EAAE;OACzB,CAAC,CACDJ,IAAI,CAAC,UAAAb,IAAI,EAAI;QACVA,IAAI,GAAGU,IAAI,CAACQ,KAAK,CAAClB,IAAI,CAAC;QACvBD,kBAAkB,CAACC,IAAI,CAAC;OAC3B,CAAC,SACI,CAAC,UAAAmB,GAAG,EAAI;QACVlB,OAAO,CAACC,GAAG,CAACiB,GAAG,CAAC;QAChBvB,oBAAoB,CAAC,wDAAwD,CAAC;OACjF,CAAC;IACN,CAAC,CAAC;;;;"}